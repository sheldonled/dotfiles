echo "$(gdate +"%T.%3N"): Loading env variables"
export HOMEBREW_PREFIX="$(brew --prefix 2>/dev/null)"
export HOMEBREW_NO_ANALYTICS=1
export HOMEBREW_BOOTSNAP=1
export EDITOR='vim'
# Ruby
export RUBY_CONFIGURE_OPTS="--with-openssl-dir=/usr/local/opt/openssl@1.1 --with-readline-dir=/usr/local/opt/readline"
# Added by GDK bootstrap
export PKG_CONFIG_PATH="/usr/local/opt/icu4c/lib/pkgconfig:${PKG_CONFIG_PATH}"
# Home bin, and dotfiles bin
export PATH="./bin:$DOTFILES/bin:$PATH"
# improve ls colors
export CLICOLOR=1

echo "$(gdate +"%T.%3N"): Initializing the zsh completion system"
autoload -Uz compinit
if [ $(date +'%j') != $(/usr/bin/stat -f '%Sm' -t '%j' $HOME/.zcompdump) ]; then
  rm -f $HOME/.zcompdump; compinit
else
  compinit -C
fi
autoload -Uz bashcompinit && bashcompinit
autoload -Uz colors && colors

echo "$(gdate +"%T.%3N"): Loading zsh theme and plugins"
setopt prompt_subst
source $HOME/.zsh/themes/cobalt2/cobalt2.zsh-theme
source $HOME/.zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh
source $HOME/.zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

fpath=($HOME/.zsh/plugins/zsh-completions/src $fpath)

echo "$(gdate +"%T.%3N"): Loading asdf"
source "${HOMEBREW_PREFIX}/opt/asdf/asdf.sh"

# Source the other env files in env.d/macos
for env in $DOTFILES/env/env.d/macos{,.private}/*; do
  echo "$(gdate +"%T.%3N"): Loading: $env"
  source $env
done

clear